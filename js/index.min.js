var composite=new dc.CompositeChart(d3.select("div.container").append("div")),suArea=[],suPerc=[];Promise.all([d3.csv("mun_area.csv"),d3.csv("mun_percent.csv")]).then((function(results){suArea=results[0],suPerc=results[1];var ndx=crossfilter();ndx.add(suArea.sort((a,b)=>b.area-a.area).map((function(d,index){let ret;return{x:index,y2:0,y1:d.area}}))),ndx.add(suPerc.sort((a,b)=>b.perc-a.perc).map((function(d,index){let ret;return{x:index,y1:0,y2:d.perc}})));var dim=ndx.dimension(dc.pluck("x")),grp1=dim.group().reduceSum(dc.pluck("y1")),grp2=dim.group().reduceSum(dc.pluck("y2"));let totalPercent=0,wDefault=768,hDefault=350,aBar=new dc.BarChart(composite).dimension(dim).colors("blue").group(grp1,"Total area of DETER alerts in 30 days (km²)").title((function(d){let suName,suCode;return"Name: "+suArea[d.key].name.split(":")[0]+"\nCode: "+suArea[d.key].name.split(":")[1]+"\nIndividual area: "+d.value+" km²"})).yAxisPadding("5%").centerBar(!0),aLine=new dc.LineChart(composite).dimension(dim).colors("red").group(grp2,"Accumulated % of the total").valueAccessor((function(d){return 0==d.key&&(totalPercent=0),totalPercent+=d.value,totalPercent})).title((function(d){let suName,suCode;return 0==d.key&&(totalPercent=0),totalPercent+=d.value,"Name: "+suArea[d.key].name.split(":")[0]+"\nCode: "+suArea[d.key].name.split(":")[1]+"\nIndividual percentage: "+d.value.toFixed(2)+"%\nTotal percentage: "+totalPercent.toFixed(2)+"%"})).useRightYAxis(!0).elasticY(!0).renderDataPoints({radius:3,fillOpacity:.9,strokeOpacity:.9}).brushOn(!1),wLegendItem=250,wLegendTotal=698,leg=dc.legend().x(134).y(340).horizontal(!0).itemWidth(250).legendWidth(698).itemHeight(15).gap(3);composite.width(768).height(350).margins({top:10,left:35,right:35,bottom:50}).x(d3.scaleLinear()).xAxisPadding(.5).elasticX(!0).legend(leg).renderHorizontalGridLines(!0).renderVerticalGridLines(!0).shareTitle(!1).compose([aBar,aLine]).rightY(d3.scaleLinear().domain([0,105])).brushOn(!1),composite.rightYAxis().tickFormat((function(v){return v+"%"})),composite.render()}));